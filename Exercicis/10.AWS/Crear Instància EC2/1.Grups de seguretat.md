# Seguretat instància EC2

```bash
aws ec2 describe-security-groups --query "SecurityGroups[*].[GroupId,GroupName,Description]" --output table
```

El codi anterior retorna tots els grups de seguretat creats en la teva infraestructura. Cada grup de seguretat determina quins ports estan oberts per accedir a la màquina.

El següent codi

```bash
aws ec2 authorize-security-group-ingress \
     --group-id "$SECURITY_GROUP_ID" \
     --protocol tcp \
     --port 22 \
     --cidr "0.0.0.0/0" 
```
permet l'accés al port 22 de la màquina. El problema, és que la variable SECURITY_GROUP_ID no té valor associat.

# Exercici 1

- Combina les dues comandes anteriors per tal d'obrir el port 22 a la teva màquina.   

- Per a testejar que el teu codi és correcte, cal que creis a través de la inferfície web una instància EC2.

# Exercici 2

De moment, només existeix un grup de seguretat a la teva infraestructura, però és normal que a mesura que el sistema creixi, es crein nous grups de segureat per ajustar quins ports estan oberts a cada màquina.

Ajusta el teu codi anterior per tal que funcioni en el cas que hi hagi més d'un grup.

# Exercici 3

Mira't la següent documentació

https://docs.aws.amazon.com/cli/latest/reference/ec2/describe-security-groups.html

L'objectiu és que puguis determinar si un grup de seguretat permet la connexió pel port 22.

# Exercici 4

Crea un script que encapsulin els exercicis anteriors d'aquest document. Tingues en compte que el script ha de funcionar sense errors en totes les situacions

- Existeix el grup de seguretat default.  

- No existeix el grup de seguretat default.  

- El port 22 ja està obert.

- El port 22 no està obert.  

L'única certesa és que el nom del grup de seguretat és default.
